<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="phacochr">
<title>Structure et mise à jour des données BeST • phacochr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Structure et mise à jour des données BeST">
<meta property="og:description" content="phacochr">
<meta property="og:image" content="https://phacochr.github.io/phacochr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phacochr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/geocoding_logic.html">Logique du géocodage</a>
    <a class="dropdown-item" href="../articles/data_phacochr.html">Structure et mise à jour des données BeST</a>
    <a class="dropdown-item" href="../articles/performances.html">Performances et fiabilité</a>
    <a class="dropdown-item" href="../articles/anonymous_geocoding.html">Géocodage anonymisé</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/shiny_app.html">Géocoder</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phacochr/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Structure et mise à jour des données BeST</h1>
            
      
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/vignettes/data_phacochr.Rmd"><code>vignettes/data_phacochr.Rmd</code></a></small>
      <div class="d-none name"><code>data_phacochr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="données-séparées">Données séparées<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-s%C3%A9par%C3%A9es"></a>
</h2>
<p>Le package <code>phacochr</code> a la particularité de ne pas
contenir directement les données nécessaires au géocodage. C’est la
raison pour laquelle il faut lancer la fonction
<code><a href="../reference/phaco_setup_data.html">phaco_setup_data()</a></code> après l’installation du package pour que
les fonctions du package puissent fonctionner :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Charger phacochr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://phacochr.github.io/phacochr/">phacochr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Installer les données nécessaires à phacochr</span></span>
<span><span class="fu"><a href="../reference/phaco_setup_data.html">phaco_setup_data</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>La fonction <code><a href="../reference/phaco_setup_data.html">phaco_setup_data()</a></code> télécharge les fichiers
nécessaires (90Mo), qui sont alors décompressés et stockés de manière
permanente dans un répertoire de travail sur l’ordinateur. Une fois
décompressés, ces fichiers occupent une place de 265Mo sur le disque
dur. Le chemin du répertoire dépend du système d’exploitation ; il est
renseigné par la fonction lors de l’installation. Pour Windows, ce
chemin est <code>C:\Users\USERNAME\AppData\Local\phacochr</code>. Voici
en résumé ce que contiennent ces fichiers. L’utilisateur/trice peut
consulter le répertoire d’installation pour prendre connaissance plus
précisément de leur contenu. <strong>Attention : ces fichier ne peuvent
pas être modifiés !</strong></p>
<table class="table">
<colgroup>
<col width="42%">
<col width="32%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th><strong>Type de données</strong></th>
<th><strong>Descriptif</strong></th>
<th><strong>Taille</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Données BeST</strong></td>
<td>Les rues <a href="https://opendata.bosa.be/" class="external-link">BeST Address</a> et
leurs coordonnées par numéro issues des données régionales Urbis (Région
de Bruxelles-Capitale), CRAB (Région flamande) et ICAR (Région
wallonne).</td>
<td>140Mo</td>
</tr>
<tr class="even">
<td><strong>Données géospatiales Statbel et Urbis</strong></td>
<td>Des données géospatiales <a href="https://statbel.fgov.be/fr/open-data?category=209" class="external-link">Statbel</a> et
<a href="https://datastore.brussels/web/data/dataset/9651e420-2c8d-48ec-b4a1-6a43a3f6a40f" class="external-link">Urbis</a>
permettant d’une part d’ajouter des informations administratives au
géocodage (secteurs statistiques, quartiers du monitoring,
(sous-)communes…), d’autre part de fournir les limites spatiales pour
pouvoir produire des cartographies des données géocodées.</td>
<td>110Mo</td>
</tr>
<tr class="odd">
<td><strong>Données de prénom Statbel</strong></td>
<td>Une liste de tous les <a href="https://data.gov.be/fr/dataset/06b90ef7bfb3797bdafb36ec69ee8f2576b5e9e0" class="external-link">prénoms
en Belgique</a>, permettant de recoder les rues BeST contenant des
prénoms pour créer des alias avec prénom abrégé (les rues étant
usuellement écrites de cette manière).</td>
<td>8Mo</td>
</tr>
<tr class="even">
<td><strong>Tables de conversion</strong></td>
<td>Des tables de conversion nécessaires au processus de géocodage pour
lier les différentes données. Il s’agit de tables permettant de passer
du code postal à la commune, l’arrondissement ou la région, du secteur
statistique au quartier monitoring de Bruxelles, d’une table faisant la
liste des communes adjacentes pour chaque commune, etc.</td>
<td>5Mo</td>
</tr>
</tbody>
</table>
<p>Le fait que les données ne soient pas intégrées a deux avantages
:</p>
<ol style="list-style-type: decimal">
<li>Il permettra de soumettre notre package au dépôt CRAN, la taille des
packages acceptés étant limitée.</li>
<li>Il donne à l’utilisateur/trice la possibilité de mettre à jour
lui/elle-même les données. Nous développons cet élément dans le point
suivant.</li>
</ol>
</div>
<div class="section level2">
<h2 id="mise-à-jour-des-données">Mise à jour des données<a class="anchor" aria-label="anchor" href="#mise-%C3%A0-jour-des-donn%C3%A9es"></a>
</h2>
<p>Si <code>phacochr</code> repose essentiellement sur les données BeST,
les données utilisées par le package ne sont pas directement celles que
l’on peut télécharger sur le site où elles sont mises à disposition : <a href="https://opendata.bosa.be/" class="external-link uri">https://opendata.bosa.be/</a>. Les données BeST sur
lesquelles est construit <code>phacochr</code> sont en effet
transformées dans le but d’ajouter des options au, et d’augmenter la
vitesse du géocodage.</p>
<p>Voici quelques éléments constituant les transformations opérées.
L’utilisateur/trice peut prendre connaissance de l’ensemble de ces
transformations en consultant le <a href="https://github.com/phacochr/phacochr/blob/main/R/phaco_best_data_update.R" class="external-link">code
de la fonction <code>phaco_best_data_update()</code> sur Github</a>.</p>
<ul>
<li>La distinction de numéros de boite différents pour le même numéro de
rue est supprimée. <em>Par exemple, les numéros 52a et 52b sont tous
deux ramenés au 52.</em>
</li>
<li>Les rues sont doublées par langue, pour simplifier l’écriture du
code de la fonction de géocodage. C’est notamment le cas pour Bruxelles,
dont toutes les rues sont traduites en français et néérlandais. La même
rue bruxelloise est sonc située sur deux lignes dans la base de données
(une en fr, l’autre en nl).</li>
<li>Les numéros de rue avec coordonnées manquantes sont supprimées.
<em>Ce problème de coordonnées manquantes concerne uniquement la
Wallonie.</em>
</li>
<li>Les coordonnées des milieux de rues sont calculées.</li>
<li>Des alias des rues avec prénoms sont créés pour que celles-ci
existent dans une version avec prénom abrégé (les rues étant usuellement
écrites de cette manière).</li>
<li>Les secteurs statistiques sont ajoutés aux données BeST à l’aide
d’une jointure spatiale avec les données de Statbel. C’est par le biais
des secteurs statistiques que les autres informations administratives
(quartiers du monitoring, (sous-)communes…) sont ajoutées aux adresses
géocodées en fin de géocodage.</li>
<li>Les fichiers BeST sont simplifiés au maximum afin d’augmenter la
vitesse du géocodage. Les fichiers BeST originaux font 960Mo ; nous les
avons réduits à 140Mo. <em>Nous avons notamment diminué la précision des
coordonnées au mètre pour diminuer la taille des fichiers.</em>
</li>
<li>Les fichiers sont en outre scindés par arrondissement, afin de
pouvoir charger uniquement les fichiers nécessaires lors du géocodage,
réduisant significativement le temps de chargement pour géocoder les
bases de données d’adresses ne couvrant pas tout le territoire
belge.</li>
</ul>
<p>Ces opérations sont réalisées par le package lui-même à travers la
fonction <code><a href="../reference/phaco_best_data_update.html">phaco_best_data_update()</a></code>. La fonction télécharge
les dernières données BeST sur le site officiel, les transforme, y
intègre les secteurs statistiques à partir des données géospatiales et
sauvegarde le résultat dans le répertoire de travail de
<code>phacochr</code> pour être utilisées lors du géocodage. En outre,
la fonction crée toutes les tables de conversions nécessaires au
géocodage pour lier les divers éléments sur base de données
effectivement utilisées par le package (dernières données BeST
téléchargées et données géospatiales que nous avons intégrées).</p>
<p>Cette manière de faire a l’avantage majeur que l’utilisateur/trice
peut réaliser lui/elle-même la mise à jour des données. Les données BeST
sont en effet mises à jour de manière hebdomadaire, et il aurait été
beaucoup trop contraignant pour nous de mettre le package à jour toutes
les semaines pour suivre ce rythme. La fonction de mise à jour se lance
simplement de cette façon :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/phaco_best_data_update.html">phaco_best_data_update</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>La fonction détecte automatiquement si les données installées ont
plus d’une semaine, pour éviter de faire une mise à jour pour rien. Si
c’est bien le cas, elle procède alors aux téléchargements et calculs
nécessaires pour créer les données. Les opérations sont nombreuses et
peuvent prendre une dizaine de minutes pour être réalisées. L’avancement
des opérations est indiqué par différents messages successifs dans la
console.</p>
</div>
<div class="section level2">
<h2 id="précision-du-géocodage">Précision du géocodage<a class="anchor" aria-label="anchor" href="#pr%C3%A9cision-du-g%C3%A9ocodage"></a>
</h2>
<p>L’utilisateur/trice peut par ailleurs choisir le degré de précision
des coordonnées X-Y lors de cette mise à jour avec le paramètre
<code>précision</code> (par défaut réglé sur <code>"m"</code> - mètre).
Si l’utilisateur/trice veut changer le degré de précision alors que les
données ont moins d’une semaine, il/elle doit indiquer l’argument
<code>force = TRUE</code>, forçant la mise à jour. Attention : augmenter
le degré de précision diminue la vitesse de géocodage. Les arguments
possibles de la fonction sont renseignés <a href="https://phacochr.github.io/phacochr/reference/phaco_best_data_update.html">dans
le dictionnaire des fonctions</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/phaco_best_data_update.html">phaco_best_data_update</a></span><span class="op">(</span>precision <span class="op">=</span> <span class="st">"cm"</span>,</span>
<span>                       force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joel Gires, Hugo Perilleux.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
